<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Profile</title>

        <link
            rel="icon"
            type="image/x-icon"
            href="../../favicon_io/favicon.ico"
        />
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
            crossorigin="anonymous"
        />
        <link
            rel="stylesheet"
            type="text/css"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css"
        />
        <link rel="stylesheet" href="../../main.css" />
        <link rel="stylesheet" href="../../navbar/nav_styles.css" />
        <link rel="stylesheet" href="./profile.css" />
    </head>
    <style></style>
    <body>
        <div id="navbarVue">
            <div data-page="profile"></div>
        </div>

        <div id="profileVue" class="wrapper">
            <div class="profile text-center justify-content-center">
                <!-- <img class="profile-pic" src="ded.png" alt="profile picture" /> -->
                <!-- <img class="profile-pic" v-bind:src="selectedFile" alt="profile picture" /> 
                {{selectedFile}} -->

                <!-- <input type = "file" ref="fileInput" id="photo"> -->
                <!-- <button @click="$refs.fileInput.click()">Pick File</button> -->
                <!-- <button id="upload">Upload</button> -->
                <!-- <div style="border-radius: 50%;border:blueviolet 3px solid;width: 100px;height:100px;"> -->
                <img
                    id="profile-picture"
                    class="profile-pic img-fluid rounded-circle rounded-circle-dp mb-2 border border-dark"
                    style="
                        object-fit: cover;
                        object-position: 50% 50%;
                        width: 200px;
                        height: 200px;
                    "
                    :src="profile_url"
                />
                <!-- </div> -->

                <div>
                    <!-- <button>Upload Image</button> -->
                    <input
                        type="file"
                        id="imageInput"
                        ref="fileInput"
                        style="display: none"
                        accept="image/*"
                        @change=" uploadImage "
                    />
                    <button
                        class="btn btn-sm bg-secondary text-white"
                        @click="$refs.fileInput.click()"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="16"
                            height="16"
                            fill="currentColor"
                            class="bi bi-upload"
                            viewBox="0 0 16 16"
                        >
                            <path
                                d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"
                            />
                            <path
                                d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"
                            />
                        </svg>
                        &nbsp; Edit Profile Picture
                    </button>
                    <!-- <label for="imageInput">
                        
                    </label> -->
                </div>

                <h2 class="name">
                    <strong
                        ><input
                            type="text"
                            class="form-control text-center target-input main-info"
                            id="displayname"
                            name="displayname"
                            v-model="displayname"
                    /></strong>
                </h2>
                <!-- <p class="degree-text">
                    <select
                        type="dropdown"
                        class="form-select text-center target-input main-info"
                        id="degree"
                        name="degree"
                    >
                        <option
                            v-for="majorChoice in majorList"
                            :value="majorChoice"
                            :selected=" degree === majorChoice "
                        >
                            {{ majorChoice }}
                        </option>
                    </select>
                    <select
                        type="dropdown"
                        class="form-select text-center target-input main-info"
                        id="year"
                        name="year"
                    >
                        <option
                            v-for="yearChoice in yearOfStudyList"
                            :value="yearChoice"
                            :selected=" yearChoice === yearOfStudy "
                        >
                            {{ yearChoice }}
                        </option>
                    </select>
                </p> -->

                <div
                    class="additional-profile row row-cols-1 row-cols-sm-2 row-cols-md-1 text-center"
                >
                    <div class="col">
                        <span><strong>Degree</strong>:</span>
                        <select
                            type="dropdown"
                            class="form-select text-center d-inline target-input add-profile-fields"
                            id="degree"
                            name="degree"
                        >
                            <option
                                v-for="majorChoice in majorList"
                                :value="majorChoice"
                                :selected=" degree === majorChoice "
                            >
                                {{ majorChoice }}
                            </option>
                        </select>
                    </div>
                    <div class="col">
                        <span><strong>Year</strong>:</span>
                        <select
                            type="dropdown"
                            class="form-select text-center d-inline target-input add-profile-fields"
                            id="year"
                            name="year"
                        >
                            <option
                                v-for="yearChoice in yearOfStudyList"
                                :value="yearChoice"
                                :selected=" yearChoice === yearOfStudy "
                            >
                                {{ yearChoice }}
                            </option>
                        </select>
                    </div>
                </div>
                <div
                    class="additional-profile row row-cols-1 row-cols-sm-3 row-cols-md-1 text-center"
                >
                    <div class="col">
                        <span><strong>Age</strong>:</span>
                        <input
                            type="number"
                            class="form-control text-center d-inline target-input add-profile-fields"
                            name="age"
                            min="1"
                            max="99"
                            oninput="validity.valid||(value='');"
                            v-model="age"
                        />
                    </div>
                    <div class="col">
                        <span><strong>Gender</strong>:</span>
                        <select
                            type="dropdown"
                            class="form-select text-center d-inline target-input add-profile-fields"
                            id="gender"
                            name="gender"
                        >
                            <option
                                v-for="genderChoice in genderList"
                                :value="genderChoice"
                                :selected=" genderChoice === gender "
                            >
                                {{ genderChoice }}
                            </option>
                        </select>
                    </div>
                    <!-- <div class="">
                        <strong>Location</strong>:
                        <input
                            id="location_user"
                            class="form-control text-center d-inline target-input add-profile-fields"
                            type="text"
                            :value="location_user"
                        />
                    </div> -->
                    <!-- <script
                        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAv4TSlT_Tm-4Pi6x6_bkUZKgsfr_iFe5Q&region=SG&callback=initAutocomplete&libraries=places&v=weekly"
                        async
                        defer
                    ></script>

                    <script>
                        function initAutocomplete() {
                            const input =
                                document.getElementById("location_user");
                            const options = {
                                componentRestrictions: { country: "SG" },
                                strictBounds: true,
                            };
                            const autocomplete =
                                new google.maps.places.Autocomplete(
                                    input,
                                    options
                                );
                            autocomplete.setTypes(["neighborhood"]);
                        }
                    </script> -->

                    <div class="col">
                        <span><strong>MBTI</strong>:</span>
                        <select
                            type="dropdown"
                            class="form-select text-center d-inline target-input add-profile-fields"
                            id="mbti"
                            name="mbti"
                        >
                            <option
                                v-for="mbtiChoice in mbtiList"
                                :value="mbtiChoice"
                                :selected=" mbtiChoice === mbti "
                            >
                                {{ mbtiChoice }}
                            </option>
                        </select>
                    </div>
                    <!-- the link can jus change the intp part to any other personality, eg infj etc -->
                </div>
                <div class="edit-profile">
                    <form id="profile_form" action="./profile.html">
                        <input
                            type="submit"
                            class="btn btn-edit-profile edit-profile-button"
                            value="Save edits"
                            @click=" update_user_database "
                        />
                    </form>
                </div>
            </div>

            <main>
                <div class="card profile-card p-1">
                    <div class="card-body">
                        <h5 class="card-title">About Me</h5>
                        <textarea
                            class="form-control d-inline target-input bio-input"
                            id="bio"
                            name="bio"
                            maxlength="500"
                            @input="auto_grow"
                            ref="bio"
                        >
{{ bio }}</textarea
                        >
                    </div>
                </div>
                <!-- <div class="card profile-card p-1">
                    <div class="card-body">
                        <h5 class="card-title preferences">Preferences</h5>
                        <h6>Price</h6>
                        <input
                            type="range"
                            class="meter target-input"
                            id="prefPrice"
                            name="prefPrice"
                            v-model="prefPrice"
                        />
                        <h6>Comfort</h6>
                        <input
                            type="range"
                            class="meter target-input"
                            id="prefComfort"
                            name="prefComfort"
                            v-model="prefComfort"
                        />
                        <h6>Convenience</h6>
                        <input
                            type="range"
                            class="meter target-input"
                            id="prefConvenience"
                            name="prefConvenience"
                            v-model="prefConvenience"
                        />
                        <h6>Speed</h6>
                        <input
                            type="range"
                            class="meter target-input"
                            id="prefSpeed"
                            name="prefSpeed"
                            v-model="prefSpeed"
                        />
                    </div>
                </div> -->
                <div class="card profile-card p-1">
                    <div class="card-body">
                        <h5 class="card-title">CCAs</h5>
                        <div id="cca-input" class="ccaDiv" v-for="cca in ccas">
                            <input
                                type="text"
                                class="form-control text-center cca_options w-75 target-input"
                                :value="cca"
                                :disabled="cca!==''"
                                @input=" ccaInputModel "
                            />
                            <button
                                class="plus-minus-button"
                                id="plus-button"
                                v-if=" cca==='' "
                                @click=" create_new_cca "
                            >
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="20"
                                    height="20"
                                    fill="#4e7570"
                                    class="bi bi-plus-circle-fill"
                                    viewBox="0 0 16 16"
                                >
                                    <path
                                        d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"
                                    />
                                </svg>
                            </button>
                            <button
                                class="plus-minus-button"
                                v-else
                                @click=" remove_cca(cca) "
                            >
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="20"
                                    height="20"
                                    fill="#4e7570"
                                    class="bi bi-dash-circle-fill"
                                    viewBox="0 0 16 16"
                                >
                                    <path
                                        d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4.5 7.5a.5.5 0 0 0 0 1h7a.5.5 0 0 0 0-1h-7z"
                                    />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="card profile-card p-1">
                    <div class="card-body">
                        <h5 class="card-title">Socials</h5>
                        <ul class="socials-ul row">
                            <li>
                                <i
                                    class="fab fa-linkedin fa-2x profile-fab d-inline col-2"
                                ></i>
                                <div class="col-10 d-inline-block">
                                    <label for="linkedin"
                                        >{{ linkedinLink }}</label
                                    >
                                    <input
                                        type="text"
                                        class="form-control text-start d-inline target-input socials-input"
                                        name="linkedin"
                                        v-model="linkedinLinkInput"
                                    />
                                </div>
                            </li>
                            <li>
                                <i
                                    class="fab fa-facebook-square fa-2x profile-fab d-inline col-2"
                                ></i>
                                <div class="col-10 d-inline-block">
                                    <label for="facebook"
                                        >{{ facebookLink }}</label
                                    >
                                    <input
                                        type="text"
                                        class="form-control text-start d-inline target-input socials-input"
                                        name="facebook"
                                        v-model="facebookLinkInput"
                                    />
                                </div>
                            </li>
                            <li>
                                <i
                                    class="fab fa-instagram fa-2x profile-fab d-inline col-2"
                                ></i>
                                <div class="col-10 d-inline-block">
                                    <label for="instagram"
                                        >{{ instagramLink }}</label
                                    >
                                    <input
                                        type="text"
                                        class="form-control text-start d-inline target-input socials-input"
                                        name="instagram"
                                        v-model="instagramLinkInput"
                                    />
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </main>
        </div>
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
            crossorigin="anonymous"
        ></script>
        <script src="https://unpkg.com/vue@next"></script>
        <script src="../../navbar/navbar.js" type="module"></script>
        <script src="./profile.js" type="module"></script>
        <!-- <script src="./profile_mod.js" type="module"></script> -->
        <script>
            // function create_new_cca() {
            //     document.getElementById('cca-input').innerHTML += `
            //         <input
            //             type="text"
            //             class="form-control text-center cca_options w-50"
            //             name="cca3"
            //             placeholder="Add a new CCA"
            //             v-for="cca of ccas"
            //             v-model="ccas"
            //         />
            //     `
            // }
            // // used to prevent the page from refreshing after submit, because its quite annoying lol
            // var form = document.getElementById("profile_form");
            // function handleForm(event) {
            //     event.preventDefault();
            // }
            // form.addEventListener('submit', handleForm);
        </script>
        <script type="module">
            // Import the functions you need from the SDKs you need
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-app.js";
            import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-analytics.js";
            // TODO: Add SDKs for Firebase products that you want to use
            // https://firebase.google.com/docs/web/setup#available-libraries

            // Your web app's Firebase configuration
            // For Firebase JS SDK v7.20.0 and later, measurementId is optional
            const firebaseConfig = {
                apiKey: "AIzaSyCCVjpCi9lziMF130jj2UtJGiPc0MamUkY",
                authDomain: "wad2-smuth-ride.firebaseapp.com",
                databaseURL:
                    "https://wad2-smuth-ride-default-rtdb.asia-southeast1.firebasedatabase.app",
                projectId: "wad2-smuth-ride",
                storageBucket: "wad2-smuth-ride.appspot.com",
                messagingSenderId: "738000465812",
                appId: "1:738000465812:web:9d74b4f15684ed2a83a981",
                measurementId: "G-E7M5LHMTL8",
            };

            // Initialize Firebase
            const app = initializeApp(firebaseConfig);
            const analytics = getAnalytics(app);

            // function uploadImage(e){
            //     const storage = getStorage()
            //     const storageReference = storageReference(storage, 'public/myfile')
            //     const uploadTask = uploadBytesResumable(storageReference, e.target.files[0]);

            //     console.log(uploadTask)
            // }
            import {
                getStorage,
                ref as sRef,
                uploadBytesResumable,
                getDownloadURL,
            } from "https://www.gstatic.com/firebasejs/9.12.1/firebase-storage.js";

            function uploadImage(e) {
                const storage = getStorage();
                const storageReference = storageReference(
                    storage,
                    "public/myfile"
                );
                const uploadTask = uploadBytesResumable(
                    storageReference,
                    e.target.files[0]
                );

                console.log(uploadTask);
            }
        </script>
    </body>
</html>
